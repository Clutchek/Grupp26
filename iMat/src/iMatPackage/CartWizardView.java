/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package iMatPackage;

import java.util.List;
import javax.swing.DefaultListModel;
import se.chalmers.ait.dat215.project.IMatDataHandler;
import se.chalmers.ait.dat215.project.ShoppingCart;
import se.chalmers.ait.dat215.project.ShoppingItem;

/**
 *
 * @author Alexander Kloutschek
 */
public class CartWizardView extends javax.swing.JPanel {

    /**
     * Creates new form CartWizard
     */
    public CartWizardView() {
        listModel = new DefaultListModel();
        initComponents();
        updateView();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        backButton = new javax.swing.JButton();
        nextButton = new javax.swing.JButton();
        progressPanel = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        cartPanel = new javax.swing.JPanel();
        numberOfItemsLabel = new javax.swing.JLabel();
        itemLabel = new javax.swing.JLabel();
        priceLabel = new javax.swing.JLabel();
        priceNumberLabel = new javax.swing.JLabel();
        titleLabel = new javax.swing.JLabel();
        listPanel = new javax.swing.JPanel();
        cartList = new javax.swing.JList();
        nameLabel = new javax.swing.JLabel();
        prisLabel = new javax.swing.JLabel();
        amountLabel = new javax.swing.JLabel();

        setBackground(new java.awt.Color(207, 219, 231));
        addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                formFocusGained(evt);
            }
        });

        backButton.setBackground(new java.awt.Color(0, 153, 255));
        backButton.setForeground(new java.awt.Color(255, 255, 255));
        backButton.setText("< Tillbaka");
        backButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                backButtonActionPerformed(evt);
            }
        });

        nextButton.setBackground(new java.awt.Color(0, 153, 255));
        nextButton.setForeground(new java.awt.Color(255, 255, 255));
        nextButton.setText("NÃ¤sta >");
        nextButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                nextButtonActionPerformed(evt);
            }
        });

        progressPanel.setBackground(new java.awt.Color(0, 153, 255));

        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/2.png"))); // NOI18N

        javax.swing.GroupLayout progressPanelLayout = new javax.swing.GroupLayout(progressPanel);
        progressPanel.setLayout(progressPanelLayout);
        progressPanelLayout.setHorizontalGroup(
            progressPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jLabel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        progressPanelLayout.setVerticalGroup(
            progressPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jLabel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        cartPanel.setBackground(new java.awt.Color(51, 153, 255));
        cartPanel.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        numberOfItemsLabel.setForeground(new java.awt.Color(255, 255, 255));
        numberOfItemsLabel.setText("jLabel3");

        itemLabel.setForeground(new java.awt.Color(255, 255, 255));
        itemLabel.setText("Antal varor:");

        priceLabel.setForeground(new java.awt.Color(255, 255, 255));
        priceLabel.setText("Totalt pris:");

        priceNumberLabel.setForeground(new java.awt.Color(255, 255, 255));
        priceNumberLabel.setText("jLabel1");

        titleLabel.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N
        titleLabel.setForeground(new java.awt.Color(255, 255, 255));
        titleLabel.setText("Varukorg");

        listPanel.setToolTipText("");

        cartList.setBorder(javax.swing.BorderFactory.createEtchedBorder(null, new java.awt.Color(51, 51, 51)));
        cartList.setModel(listModel
        );
        cartList.setToolTipText("");

        javax.swing.GroupLayout listPanelLayout = new javax.swing.GroupLayout(listPanel);
        listPanel.setLayout(listPanelLayout);
        listPanelLayout.setHorizontalGroup(
            listPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
            .addGroup(listPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addComponent(cartList, javax.swing.GroupLayout.DEFAULT_SIZE, 389, Short.MAX_VALUE))
        );
        listPanelLayout.setVerticalGroup(
            listPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 451, Short.MAX_VALUE)
            .addGroup(listPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addComponent(cartList, javax.swing.GroupLayout.DEFAULT_SIZE, 451, Short.MAX_VALUE))
        );

        nameLabel.setForeground(new java.awt.Color(255, 255, 255));
        nameLabel.setText("Namn");

        prisLabel.setForeground(new java.awt.Color(255, 255, 255));
        prisLabel.setText("Pris");

        amountLabel.setForeground(new java.awt.Color(255, 255, 255));
        amountLabel.setText("Antal");

        javax.swing.GroupLayout cartPanelLayout = new javax.swing.GroupLayout(cartPanel);
        cartPanel.setLayout(cartPanelLayout);
        cartPanelLayout.setHorizontalGroup(
            cartPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(cartPanelLayout.createSequentialGroup()
                .addGap(25, 25, 25)
                .addComponent(itemLabel)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(numberOfItemsLabel)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 126, Short.MAX_VALUE)
                .addComponent(priceLabel)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(priceNumberLabel)
                .addGap(35, 35, 35))
            .addGroup(cartPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(listPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
            .addGroup(cartPanelLayout.createSequentialGroup()
                .addGroup(cartPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(cartPanelLayout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(nameLabel)
                        .addGap(101, 101, 101)
                        .addComponent(amountLabel)
                        .addGap(100, 100, 100)
                        .addComponent(prisLabel))
                    .addGroup(cartPanelLayout.createSequentialGroup()
                        .addGap(157, 157, 157)
                        .addComponent(titleLabel)))
                .addContainerGap(129, Short.MAX_VALUE))
        );
        cartPanelLayout.setVerticalGroup(
            cartPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, cartPanelLayout.createSequentialGroup()
                .addComponent(titleLabel)
                .addGap(10, 10, 10)
                .addGroup(cartPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(nameLabel)
                    .addComponent(prisLabel)
                    .addComponent(amountLabel))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(listPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(cartPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(numberOfItemsLabel)
                    .addComponent(itemLabel)
                    .addComponent(priceLabel)
                    .addComponent(priceNumberLabel))
                .addContainerGap())
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(progressPanel, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(layout.createSequentialGroup()
                .addGap(75, 75, 75)
                .addComponent(backButton)
                .addGap(221, 221, 221)
                .addComponent(cartPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(nextButton)
                .addGap(75, 75, 75))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(progressPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(cartPanel, javax.swing.GroupLayout.PREFERRED_SIZE, 539, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addContainerGap(45, Short.MAX_VALUE))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                        .addGap(0, 0, Short.MAX_VALUE)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(backButton)
                            .addComponent(nextButton))
                        .addGap(13, 13, 13))))
        );
    }// </editor-fold>//GEN-END:initComponents

    private void nextButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_nextButtonActionPerformed
        if(MainWindow.isLoggedIn()){
            MainWindow.showDeliveryWizardView();
        }else{
            MainWindow.showInformationChooseView();
        }
    }//GEN-LAST:event_nextButtonActionPerformed

    private void formFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_formFocusGained
        //
    }//GEN-LAST:event_formFocusGained

    private void backButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_backButtonActionPerformed
        MainWindow.showStoreView();
    }//GEN-LAST:event_backButtonActionPerformed

    public static void updateView(){
        listModel.clear();
        List<ShoppingItem> cart = IMatDataHandler.getInstance().getShoppingCart().getItems();
        double totalPrice = 0;
        for(ShoppingItem item : cart){
            String stringItem = "";
            
            stringItem = stringItem + item.getProduct().getName();
            
            int times = 40 - item.getProduct().getName().length();
            if(times > 0){
                for(int j = 0; j < times; j++){
                    stringItem = stringItem + " ";
                }
            }
            
            stringItem = stringItem + item.getAmount()+" st";
            
            times = 30 - String.valueOf(item.getAmount()).length();
            if(times > 0){
                for(int j = 0; j < times; j++){
                    stringItem = stringItem + " ";
                }
            }
            stringItem = stringItem + item.getTotal()+" kr";

            listModel.addElement(stringItem);
            totalPrice = totalPrice + item.getTotal();
        }
        priceNumberLabel.setText(String.valueOf(totalPrice)+ "kr");
        numberOfItemsLabel.setText(String.valueOf(cart.size()));
        priceNumberLabel.repaint();
        numberOfItemsLabel.repaint();
        cartList.repaint();
    }

    private static DefaultListModel listModel;
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel amountLabel;
    private javax.swing.JButton backButton;
    private static javax.swing.JList cartList;
    private javax.swing.JPanel cartPanel;
    private static javax.swing.JLabel itemLabel;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JPanel listPanel;
    private javax.swing.JLabel nameLabel;
    private javax.swing.JButton nextButton;
    private static javax.swing.JLabel numberOfItemsLabel;
    private static javax.swing.JLabel priceLabel;
    private static javax.swing.JLabel priceNumberLabel;
    private javax.swing.JLabel prisLabel;
    private javax.swing.JPanel progressPanel;
    private javax.swing.JLabel titleLabel;
    // End of variables declaration//GEN-END:variables
}
